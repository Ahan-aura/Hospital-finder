<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hospital Portal - Your Health Partner</title>
    <meta name="description" content="Your trusted health partner. Book appointments, find doctors, and access quality care effortlessly.">
    <meta name="keywords" content="hospital, doctors, appointments, health, medical">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Enhanced Base Styles - Keeping Original Color Theme */
        :root {
            --primary: #02475b;
            --primary-dark: #04677f;
            --secondary: #05596b;
            --bg-light: #f3f7fa;
            --card-bg: #fff;
            --text-light: #95a1be;
            --accent: #12d8c5;
            --shadow-soft: 0 2px 10px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 4px 20px rgba(0, 0, 0, 0.12);
            --border-radius: 18px;
            --transition: all 0.3s ease;
        }

        * { box-sizing: border-box; }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--primary);
            line-height: 1.6;
            overflow-x: hidden;
            padding-top: 120px;
            margin: 0;
        }
        .modal-open { overflow: hidden; }

        /* Enhanced Sticky Header */
        .header-container {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 999;
            background: var(--card-bg);
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
        }
        .navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 4vw;
            gap: 24px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .logo {
            display: flex;
            align-items: center;
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary);
            height: 50px;
        }
        .logo img {
            height: 100%;
            width: auto;
            border-radius: 8px;
            margin-right: 8px;
            transition: var(--transition);
        }
        .logo img:hover { transform: scale(1.05); }

        .location-wrapper { position: relative; min-width: 180px; }
        .location-pill {
            display: flex; align-items: center; gap: 8px;
            background: #eaf3f5; color: var(--primary);
            padding: 10px 16px; border-radius: var(--border-radius);
            font-weight: 500; font-size: 0.95rem;
            border: 1px solid #d4e8ec; transition: var(--transition);
            cursor: pointer; justify-content: space-between;
        }
        .location-pill:hover {
            background: #d8edf0; box-shadow: var(--shadow-soft);
            transform: translateY(-1px);
        }
        .location-pill i { color: var(--primary); font-size: 1.1em; }
        .location-pill > span { flex-grow: 1; text-align: left; min-width: 100px; }
        .location-pill button {
            background: transparent; border: none; color: var(--primary);
            cursor: pointer; font-size: 0.95em; padding: 0 5px 0 0;
            transition: var(--transition);
        }
        .location-pill button:hover { color: var(--primary-dark); }

        .dropdown {
            display: none; position: absolute; top: 45px; left: 0;
            width: 100%; background: var(--card-bg); border: 1px solid #cdebf3;
            border-radius: 8px; box-shadow: var(--shadow-medium); z-index: 10;
            overflow: hidden;
        }
        .dropdown select {
            width: 100%; font-size: 1rem; padding: 12px; border: none;
            color: var(--primary); outline: none; cursor: pointer; background: transparent;
        }

        .search-pill {
            display: flex; align-items: center;
            background: #f6fafc; border-radius: var(--border-radius);
            border: 1px solid #e1e7ec; box-shadow: none;
            max-width: 450px; width: 100%; padding: 10px 16px;
            transition: var(--transition);
        }
        .search-pill:hover, .search-pill:focus-within {
            box-shadow: 0 0 0 2px rgba(18, 216, 197, 0.3);
            border-color: var(--accent);
        }
        .search-pill .fa-magnifying-glass { font-size: 1rem; color: #7bbdd6; margin-right: 10px; }
        .search-pill input {
            border: none; background: transparent; font-size: 1rem;
            outline: none; color: var(--primary); width: 100%;
        }
        .search-pill input::placeholder { color: var(--text-light); }
        /* New: Search Results Dropdown */
        .search-results {
            position: absolute; top: 100%; left: 0; right: 0; background: var(--card-bg);
            border: 1px solid #e1e7ec; border-radius: 0 0 var(--border-radius) var(--border-radius);
            max-height: 300px; overflow-y: auto; display: none; z-index: 10;
            box-shadow: var(--shadow-medium);
        }
        .search-result-item {
            padding: 12px 16px; cursor: pointer; border-bottom: 1px solid #f0f0f0;
            transition: var(--transition);
        }
        .search-result-item:hover { background: #eaf3f5; }
        .search-result-item:last-child { border-bottom: none; }

        /* Login/User Pills - Enhanced */
        .login-pill, .user-pill {
            display: flex; align-items: center; gap: 8px;
            font-weight: 600; font-size: 1rem; border-radius: var(--border-radius);
            padding: 10px 20px; cursor: pointer; transition: var(--transition);
            box-shadow: none; text-decoration: none;
        }
        .login-pill {
            border: 2px solid var(--primary); background: var(--card-bg); color: var(--primary);
        }
        .login-pill:hover {
            background: var(--primary); color: #fff; box-shadow: var(--shadow-soft);
            transform: translateY(-1px);
        }
        .user-pill { display: none; background: var(--primary); color: #fff; border: 2px solid var(--primary); }
        .user-pill:hover { background: var(--primary-dark); }
        .user-pill .fa-circle-user { font-size: 1.2em; color: #fff; }
        .user-dropdown {
            display: none; position: absolute; top: 100%; right: 0;
            background: var(--card-bg); border-radius: 8px; box-shadow: var(--shadow-medium);
            margin-top: 10px; width: 180px; z-index: 100; overflow: hidden;
        }
        .user-dropdown a {
            display: block; padding: 12px 16px; color: var(--primary); text-decoration: none;
            font-size: 0.95rem; font-weight: 500; transition: var(--transition);
        }
        .user-dropdown a:hover { background: #eaf3f5; }

        /* Enhanced Bottom Navbar */
        .bottom-navbar {
            background: #fdfdfd; max-width: 1200px; margin: 0 auto;
            box-shadow: var(--shadow-soft);
        }
        .bottom-navbar ul {
            display: flex; justify-content: center; align-items: center; gap: 40px;
            padding: 12px 0; margin: 0; list-style: none;
        }
        .bottom-navbar ul li a {
            font-size: 0.95rem; font-weight: 500; color: #0e404b;
            text-decoration: none; padding: 8px 12px; border-radius: 8px;
            transition: var(--transition); position: relative;
        }
        .bottom-navbar ul li a:hover {
            background: var(--primary); color: #fff; transform: translateY(-1px);
        }

        /* Enhanced Hero */
        .hero {
            text-align: center; margin: 80px auto 0; background: linear-gradient(135deg, #e6f3f5 0%, #f8fbfd 100%);
            padding: 100px 5vw 80px; border-radius: var(--border-radius); width: 90%;
            box-shadow: var(--shadow-medium); animation: fadeIn 1.2s; max-width: 1000px;
        }
        .hero h1 { font-size: 3.5rem; color: var(--primary); margin-bottom: 20px; font-weight: 700; }
        .hero p { font-size: 1.2rem; color: var(--secondary); margin-bottom: 16px; }
        .btn-row { display: flex; justify-content: center; gap: 20px; margin-top: 40px; flex-wrap: wrap; }
        .hero .A8, .hero .A9 {
            font-size: 1.1rem; padding: 16px 40px; border-radius: 32px; border: none;
            font-weight: 600; cursor: pointer; transition: var(--transition);
            box-shadow: 0 3px 9px rgba(227, 239, 255, 0.5); position: relative; overflow: hidden;
        }
        .hero .A8 { background: var(--primary); color: #fff; }
        .hero .A8::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s; }
        .hero .A8:hover::before { left: 100%; }
        .hero .A8:hover { background: var(--primary-dark); transform: translateY(-3px); box-shadow: var(--shadow-medium); }
        .hero .A9 { background: var(--card-bg); color: var(--primary); border: 2px solid var(--primary); }
        .hero .A9:hover { background: var(--primary); color: #fff; transform: translateY(-3px); box-shadow: var(--shadow-medium); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }

        /* Hospitals Section - Enhanced */
        .hospitals-section { max-width: 1200px; margin: 80px auto 0; padding: 0 5vw; display: none; }
        .hospitals-section h2 { text-align: center; font-size: 1.8rem; font-weight: 700; color: var(--primary); margin-bottom: 24px; }
        .hospitals-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 24px; }
        .hospital-card {
            background: var(--card-bg); border-radius: var(--border-radius); box-shadow: var(--shadow-soft);
            padding: 24px; transition: var(--transition); position: relative;
        }
        .hospital-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--accent); transform: scaleX(0); transition: var(--transition); }
        .hospital-card:hover::before { transform: scaleX(1); }
        .hospital-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-medium); }
        .hospital-card h3 { color: var(--primary); margin-bottom: 12px; font-size: 1.3rem; }
        .hospital-card p { color: var(--secondary); margin-bottom: 16px; }
        .hospital-card a {
            color: #fff; background: var(--primary); padding: 10px 20px;
            border-radius: 20px; text-decoration: none; font-weight: 500; display: inline-flex;
            align-items: center; gap: 8px; transition: var(--transition);
        }
        .hospital-card a:hover { background: var(--primary-dark); transform: translateY(-1px); }
        .hospitals-loading, .no-hospitals { text-align: center; padding: 50px; color: var(--secondary); }
        .hospitals-loading i { font-size: 2.5rem; color: var(--accent); animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Features Section - Enhanced with Subtle Animations */
        .features-section { max-width: 1200px; margin: 80px auto 0; padding: 0 5vw; }
        .features-section > div { text-align: center; font-size: 1.5rem; color: var(--primary); font-weight: 600; margin-bottom: 40px; }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; }
        .feature-card {
            background: var(--card-bg); border-radius: var(--border-radius); box-shadow: var(--shadow-soft);
            padding: 40px 24px; text-align: center; font-size: 1.1rem; color: var(--secondary);
            font-weight: 500; transition: var(--transition); position: relative; opacity: 0; transform: translateY(20px);
            animation: fadeInUp 0.6s forwards;
        }
        .feature-card:nth-child(1) { animation-delay: 0.1s; }
        .feature-card:nth-child(2) { animation-delay: 0.2s; }
        .feature-card:nth-child(3) { animation-delay: 0.3s; }
        .feature-card:nth-child(4) { animation-delay: 0.4s; }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
        .feature-card:hover { box-shadow: var(--shadow-medium); transform: translateY(-5px); }
        .feature-card i {
            font-size: 2.5em; padding: 20px; background: #eafbff; border-radius: 50%;
            color: var(--primary); margin-bottom: 16px; box-shadow: 0 1px 6px rgba(18, 216, 197, 0.1);
            transition: var(--transition);
        }
        .feature-card:hover i { transform: scale(1.1); color: var(--primary-dark); }

        /* Specialties Section - Enhanced */
        .specialties-section { margin: 80px auto 0; max-width: 1200px; padding: 0 5vw; }
        .specialties-title {
            text-align: center; font-size: 1.8rem; font-weight: 700; margin-bottom: 24px; color: var(--primary);
            position: relative;
        }
        .specialties-title::after {
            content: ''; position: absolute; bottom: -8px; left: 50%; width: 60px; height: 3px;
            background: var(--accent); transform: translateX(-50%);
        }
        .specialties-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 40px; margin-top: 20px; }
        .specialty-card {
            cursor: pointer; background: var(--card-bg); border-radius: var(--border-radius); box-shadow: var(--shadow-soft);
            padding: 32px 20px; text-align: center; transition: var(--transition); font-size: 1rem;
            position: relative;
        }
        .specialty-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--accent);
            transform: scaleX(0); transition: var(--transition);
        }
        .specialty-card:hover::before { transform: scaleX(1); }
        .specialty-card:hover { box-shadow: var(--shadow-medium); transform: translateY(-6px) scale(1.02); }
        .specialty-card i {
            background: #eafbff; color: var(--primary); font-size: 2.2em; border-radius: 50%; padding: 16px;
            margin-bottom: 16px; box-shadow: 0 1px 6px rgba(18, 216, 197, 0.1); transition: var(--transition);
        }
        .specialty-card:hover i { background: var(--primary); color: #fff; transform: scale(1.1); }
        .specialty-card strong { display: block; font-size: 1.2em; margin-bottom: 8px; color: var(--primary-dark); font-weight: 600; }

        /* Enhanced Carousel - Auto-scrolling */
        .carousel-section { margin: 100px auto 0; max-width: 1000px; padding: 0 5vw; }
        .carousel-title { text-align: center; font-size: 1.5rem; font-weight: 700; color: var(--primary); margin-bottom: 24px; }
        .carousel {
            display: flex; overflow: hidden; gap: 40px; padding: 20px 0; justify-content: flex-start;
            scroll-behavior: smooth; position: relative;
        }
        .testimonial {
            min-width: 320px; max-width: 380px; background: var(--card-bg); border-radius: var(--border-radius);
            box-shadow: var(--shadow-soft); padding: 32px 24px; display: flex; flex-direction: column;
            align-items: center; transition: var(--transition); flex-shrink: 0;
        }
        .testimonial .fas.fa-quote-left { color: var(--primary); font-size: 2.5rem; margin-bottom: 16px; opacity: 0.8; }
        .testimonial div { 
            font-style: italic; color: var(--secondary); margin-bottom: 16px; text-align: center; 
            font-size: 1rem; hyphens: auto; word-wrap: break-word; line-height: 1.5;
        }
        .testimonial .person { font-weight: 600; color: var(--primary); align-self: flex-end; }
        .testimonial:hover { transform: translateY(-5px); box-shadow: var(--shadow-medium); }

        /* New: Health Tips Section */
        .health-tips-section {
            max-width: 1200px; margin: 80px auto; padding: 0 5vw; background: var(--card-bg);
            border-radius: var(--border-radius); box-shadow: var(--shadow-soft); overflow: hidden;
        }
        .health-tips-header { text-align: center; padding: 40px 0; }
        .health-tips-header h2 { font-size: 1.8rem; color: var(--primary); margin-bottom: 8px; }
        .health-tips-header p { color: var(--secondary); font-size: 1.1rem; }
        .tips-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; padding: 0 40px 40px; }
        .tip-card {
            padding: 24px; border-left: 4px solid var(--accent); transition: var(--transition);
            background: linear-gradient(to right, #f8fbfd, var(--card-bg));
        }
        .tip-card:hover { box-shadow: var(--shadow-soft); transform: translateX(5px); }
        .tip-card i { color: var(--accent); font-size: 1.5rem; margin-bottom: 12px; }
        .tip-card h3 { color: var(--primary); margin-bottom: 8px; font-size: 1.2rem; }

        /* Enhanced CTA */
        .cta-section {
            margin: 100px auto 0; background: linear-gradient(90deg, #eafdff 0%, #f8fbfd 100%);
            border-radius: var(--border-radius); box-shadow: var(--shadow-medium); max-width: 900px;
            text-align: center; padding: 60px 8vw 50px;
        }
        .cta-section h2 { font-size: 2.5rem; color: var(--primary); margin-bottom: 20px; font-weight: 700; }
        .cta-section p { color: var(--primary-dark); font-size: 1.2rem; margin-bottom: 40px; }
        .cta-section .cta-btn {
            background: var(--primary); color: #fff; font-size: 1.1rem; border: none; border-radius: 32px;
            padding: 18px 50px; font-weight: 600; cursor: pointer; box-shadow: 0 3px 9px rgba(18, 216, 197, 0.1);
            transition: var(--transition);
        }
        .cta-section .cta-btn:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-soft); }

        /* New: Newsletter Signup in CTA */
        .newsletter { margin-top: 30px; display: flex; justify-content: center; gap: 10px; max-width: 400px; margin-left: auto; margin-right: auto; }
        .newsletter input { padding: 12px 16px; border: 1px solid #d4e8ec; border-radius: 25px; width: 250px; font-size: 1rem; }
        .newsletter button { padding: 12px 20px; background: var(--primary); color: #fff; border: none; border-radius: 25px; cursor: pointer; transition: var(--transition); }
        .newsletter button:hover { background: var(--primary-dark); }

        /* Enhanced Footer */
        .footer {
            background: var(--card-bg); color: var(--primary); padding: 50px 8vw 30px; text-align: center;
            box-shadow: var(--shadow-soft); font-size: 1.1rem; margin-top: 80px;
        }
        .footer > div:first-child { font-weight: 500; margin-bottom: 12px; }
        .footer .socials { margin: 20px 0; }
        .footer .socials a { color: var(--primary); margin: 0 16px; font-size: 1.5rem; transition: var(--transition); }
        .footer .socials a:hover { color: var(--accent); transform: translateY(-2px); }
        .footer > div:last-child { margin-top: 20px; opacity: 0.7; font-size: 0.95em; }

        /* Enhanced Modals */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6); z-index: 1000; display: none;
            justify-content: center; align-items: center; padding: 20px;
            backdrop-filter: blur(4px);
        }
        .login-modal, .signup-modal, .medical-info-modal {
            background: var(--card-bg); border-radius: var(--border-radius); box-shadow: var(--shadow-medium);
            padding: 40px; max-width: 450px; width: 100%; animation: slideIn 0.3s ease-out;
        }
        .medical-info-modal { max-width: 600px; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .modal-header h2 { color: var(--primary); font-size: 1.8rem; margin: 0; font-weight: 600; }
        .close-btn {
            font-size: 2rem; font-weight: 300; color: #7bbdd6; cursor: pointer; transition: var(--transition);
            background: none; border: none;
        }
        .close-btn:hover { color: var(--primary); transform: rotate(90deg); }
        .form-group { margin-bottom: 20px; }
        .login-form label, .signup-form label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--secondary); font-size: 1rem; }
        .login-form input, .signup-form input {
            width: 100%; padding: 14px 16px; border: 1px solid #cdebf3; border-radius: 8px;
            font-size: 1rem; color: var(--primary); transition: var(--transition);
        }
        .login-form input:focus, .signup-form input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(18, 216, 197, 0.2); outline: none; }
        .submit-btn {
            width: 100%; background: var(--primary); color: #fff; font-size: 1.1rem; font-weight: 600;
            padding: 16px; border: none; border-radius: 32px; cursor: pointer; margin-top: 12px;
            transition: var(--transition);
        }
        .submit-btn:hover { background: var(--primary-dark); transform: translateY(-1px); box-shadow: var(--shadow-soft); }
        .form-footer { text-align: center; margin-top: 20px; }
        .form-footer a { color: #17646f; font-size: 1rem; text-decoration: none; font-weight: 500; }
        .form-footer a:hover { text-decoration: underline; color: var(--accent); }
        .error-message {
            color: #d9534f; background: #f2dede; border: 1px solid #ebccd1; padding: 10px 14px;
            border-radius: 8px; margin-top: 16px; font-size: 0.95rem; font-weight: 500; text-align: center;
        }

        .loading-spinner { text-align: center; padding: 40px 0; }
        .loading-spinner i { font-size: 3rem; color: var(--accent); animation: spin 1.5s linear infinite; }
        .source-list { margin-top: 20px; border-top: 1px solid #eee; padding-top: 16px; }
        .source-list strong { font-size: 1rem; color: var(--primary); display: block; margin-bottom: 8px; }
        .source-list a { font-size: 0.9rem; color: #17646f; display: block; margin-bottom: 6px; text-decoration: none; }
        .source-list a:hover { text-decoration: underline; color: var(--accent); }

        /* New: Appointment Modal */
        .appointment-modal { max-width: 500px; }
        .calendar { margin: 20px 0; text-align: center; }
        .calendar button { margin: 5px; padding: 8px 12px; background: var(--primary); color: #fff; border: none; border-radius: 5px; cursor: pointer; }
        .calendar button:hover { background: var(--primary-dark); }
        .time-slots { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 20px; }
        .time-slot { padding: 10px 15px; background: #eaf3f5; border-radius: 20px; cursor: pointer; transition: var(--transition); }
        .time-slot:hover, .time-slot.selected { background: var(--primary); color: #fff; }

        /* Responsive */
        @media (max-width: 768px) {
            body { padding-top: 180px; }
            .navbar { flex-direction: column; gap: 20px; padding: 20px 4vw; }
            .bottom-navbar ul { gap: 20px; flex-wrap: wrap; }
            .location-wrapper, .search-pill, .login-pill, .user-pill { width: 100%; max-width: 300px; justify-content: center; }
            .hero h1 { font-size: 2.8rem; }
            .tips-grid { grid-template-columns: 1fr; padding: 0 20px 40px; }
            .newsletter { flex-direction: column; align-items: center; }
            .newsletter input { width: 100%; max-width: 250px; }
            .testimonial { min-width: 280px; max-width: 100%; }
        }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-50px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div class="header-container">
        <div class="navbar">
            <div class="logo">
                <img src="https://static.vecteezy.com/system/resources/previews/046/305/217/original/hospital-logo-design-illustration-vector.jpg" alt="Hospital Logo" />
            </div>
            <div class="location-wrapper">
                <div class="location-pill" id="location">
                    <i class="fa-solid fa-location-dot"></i>
                    <span id="locationText">Detecting...</span>
                    <button id="locationToggleBtn" style="display:none;" title="Toggle between City and Coordinates">
                        <i class="fas fa-arrows-left-right-to-line"></i>
                    </button>
                </div>
                <div class="dropdown" id="locationDropdown">
                    <select id="citySelect">
                        <option value="">Select Your City</option>
                        <option value="Hyderabad">Hyderabad</option>
                        <option value="Bangalore">Bangalore</option>
                        <option value="Chennai">Chennai</option>
                        <option value="Mumbai">Mumbai</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Kolkata">Kolkata</option>
                        <option value="Pune">Pune</option>
                    </select>
                </div>
            </div>
            <div class="search-pill" style="position: relative;">
                <i class="fa fa-magnifying-glass"></i>
                <input type="search" id="searchInput" placeholder="Search Doctors, Specialities, Conditions, etc..." />
                <div class="search-results" id="searchResults"></div>
            </div>
            <button class="login-pill" id="loginButton">
                Login&nbsp;<i class="fa-regular fa-circle-user"></i>
            </button>
            <button class="user-pill" id="userPill">
                <span id="userEmailDisplay"></span>&nbsp;<i class="fa-regular fa-circle-user"></i>
                <div class="user-dropdown" id="userDropdown">
                    <a href="#">Profile</a>
                    <a href="appo.html">My Appointments</a>
                    <a id="logoutLink">Logout</a>
                </div>
            </button>
        </div>
        <div class="bottom-navbar">
            <ul>
                <li><a href="find.html">Find a Doctor</a></li>
                <li><a href="bloodBank.html">Blood Bank</a></li>
                <li><a href="health.html">Health Packages</a></li>
                <li><a href="#">Medical Conditions</a></li>
                <li><a href="#" onclick="showQuickConsult()">Consult Online</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </div>
    </div>

    <div class="hero">
        <h1>Your Health Partner</h1>
        <p>Find experienced doctors across multiple specialties that our hospital offers.</p>
        <p>Get access to quality care from Physicians, Cardiologists, Dentists, Orthopedic Surgeons<br>and more — all in one place.</p>
        <div class="btn-row">
            <button class="A8" onclick="window.location.href='appo.html'">Book Appointment</button>
            <button class="A9" onclick="window.location.href='map.html'">Find hospital</button>
        </div>
    </div>

    <section class="hospitals-section" id="hospitalsSection">
        <h2>Nearby Hospitals</h2>
        <div class="hospitals-loading" id="hospitalsLoading">
            <i class="fas fa-spinner"></i>
            <p>Searching for nearby hospitals...</p>
        </div>
        <div class="hospitals-grid" id="hospitalsGrid" style="display:none;"></div>
        <div class="no-hospitals" id="noHospitals" style="display:none;">
            <i class="fas fa-map-marker-alt"></i>
            <p>No hospitals found nearby. Try selecting a different location.</p>
        </div>
    </section>

    <section class="features-section">
        <div>Why Choose Us?</div>
        <div class="features-grid">
            <div class="feature-card">
                <i class="fa-solid fa-heart-pulse"></i>
                Top Specialists With Years of Experience
            </div>
            <div class="feature-card">
                <i class="fa-solid fa-user-shield"></i>
                Safe & Secure Medical Records
            </div>
            <div class="feature-card">
                <i class="fa-solid fa-calendar-check"></i>
                Fast Booking & Easy Appointments
            </div>
            <div class="feature-card">
                <i class="fa-solid fa-house-chimney-medical"></i>
                Advanced Facilities & Latest Equipment
            </div>
        </div>
    </section>

    <section class="specialties-section">
        <div class="specialties-title">Featured Specialties (Click for ✨Info)</div>
        <div class="specialties-grid" id="specialtiesGrid">
            <div class="specialty-card" data-specialty="Cardiology">
                <i class="fa-solid fa-heartbeat"></i>
                <strong>Cardiology</strong>
                Heart & Vascular Care
            </div>
            <div class="specialty-card" data-specialty="Family Medicine">
                <i class="fa-solid fa-pills"></i>
                <strong>Family Medicine</strong>
                General Health Check
            </div>
            <div class="specialty-card" data-specialty="Dentistry">
                <i class="fa-solid fa-tooth"></i>
                <strong>Dentistry</strong>
                Oral Health & Hygiene
            </div>
            <div class="specialty-card" data-specialty="Orthopedics">
                <i class="fa-solid fa-bone"></i>
                <strong>Orthopedics</strong>
                Bone & Joint Care
            </div>
            <div class="specialty-card" data-specialty="Neurology">
                <i class="fa-solid fa-brain"></i>
                <strong>Neurology</strong>
                Brain & Nervous System
            </div>
            <div class="specialty-card" data-specialty="Pulmonology">
                <i class="fa-solid fa-lungs"></i>
                <strong>Pulmonology</strong>
                Lungs & Breathing Health
            </div>
        </div>
    </section>

    <section class="carousel-section">
        <div class="carousel-title">What Our Patients Say</div>
        <div class="carousel" id="testimonialCarousel">
            <div class="testimonial">
                <i class="fas fa-quote-left"></i>
                <div>Wonderful experience—booking was easy, and doctors are very helpful. Highly recommend this portal for your health needs!</div>
                <div class="person">— Ritu Sharma</div>
            </div>
            <div class="testimonial">
                <i class="fas fa-quote-left"></i>
                <div>The online consultation saved me a lot of time. Fast, reliable, and trustworthy.</div>
                <div class="person">— Abhishek Kumar</div>
            </div>
            <div class="testimonial">
                <i class="fas fa-quote-left"></i>
                <div>The interface is beautiful and simple. Loved the easy booking and specialist selection. Thank you!</div>
                <div class="person">— Neha Saxena</div>
            </div>
        </div>
    </section>

    <!-- New: Health Tips Section -->
    <section class="health-tips-section">
        <div class="health-tips-header">
            <h2>Daily Health Tips</h2>
            <p>Stay informed with quick wellness advice from our experts.</p>
        </div>
        <div class="tips-grid">
            <div class="tip-card">
                <i class="fas fa-apple-whole"></i>
                <h3>Balanced Diet</h3>
                <p>Incorporate more fruits and vegetables into your meals for better nutrition and energy levels.</p>
            </div>
            <div class="tip-card">
                <i class="fas fa-running"></i>
                <h3>Stay Active</h3>
                <p>Aim for 30 minutes of moderate exercise daily to boost your heart health and mood.</p>
            </div>
            <div class="tip-card">
                <i class="fas fa-bed"></i>
                <h3>Quality Sleep</h3>
                <p>Prioritize 7-9 hours of sleep each night to support immune function and mental clarity.</p>
            </div>
        </div>
    </section>

    <section class="cta-section">
        <h2>Ready to Take Control of Your Health?</h2>
        <p>Book your appointment in less than a minute, and get access to world-class healthcare and caring specialists across all departments. Your health, simplified and secured.</p>
        <button class="cta-btn" onclick="showAppointmentModal()">Book Now</button>
        <div class="newsletter">
            <input type="email" placeholder="Subscribe for health updates" id="newsletterEmail">
            <button onclick="subscribeNewsletter()">Subscribe</button>
        </div>
    </section>

    <footer class="footer">
        <div>
            Your Hospital – Caring for you, always.<br>
            <div>Call us: <b>+91 90000 00000</b> | Email: <b>contact@yourhospital.com</b></div>
        </div>
        <div class="socials">
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-youtube"></i></a>
        </div>
        <div>© 2025 Your Hospital. All Rights Reserved.</div>
    </footer>

    <!-- Existing Modals -->
    <div class="modal-overlay" id="loginModalOverlay">
        <div class="login-modal">
            <div class="modal-header">
                <h2>Patient Login</h2>
                <span class="close-btn login-close-btn">&times;</span>
            </div>
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="username">Email:</label>
                    <input type="email" id="username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <button type="submit" class="submit-btn">Login Securely</button>
                <div class="error-message" id="loginErrorMessage" style="display:none;"></div>
                <div class="form-footer">
                    New User? <a id="showSignupLink">Sign Up Here</a>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="signupModalOverlay" style="display:none;">
        <div class="signup-modal">
            <div class="modal-header">
                <h2>Register New Account</h2>
                <span class="close-btn signup-close-btn">&times;</span>
            </div>
            <form class="signup-form" id="signupForm">
                <div class="form-group">
                    <label for="signupEmail">Email:</label>
                    <input type="email" id="signupEmail" name="signupEmail" required>
                </div>
                <div class="form-group">
                    <label for="signupPassword">Password:</label>
                    <input type="password" id="signupPassword" name="signupPassword" required minlength="6">
                </div>
                <button type="submit" class="submit-btn">Create Account</button>
                <div class="error-message" id="signupErrorMessage" style="display:none;"></div>
                <div class="form-footer">
                    Already have an account? <a id="showLoginLink">Login</a>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="medicalInfoModalOverlay" style="display:none;">
        <div class="medical-info-modal">
            <div class="modal-header">
                <h2 id="medicalInfoTitle"></h2>
                <span class="close-btn medical-info-close-btn">&times;</span>
            </div>
            <div id="medicalInfoContent">
                <div class="loading-spinner" id="medicalInfoLoading">
                    <i class="fas fa-spinner"></i>
                    <p>✨ Generating summary and checking latest information...</p>
                </div>
                <div id="medicalInfoResult" style="display:none;">
                    <p id="medicalInfoText"></p>
                    <div class="source-list" id="medicalInfoSources"></div>
                    <button class="submit-btn" style="margin-top: 20px; width: auto; padding: 10px 20px;" onclick="copySummary()"><i class="fas fa-copy"></i> Copy Summary</button>
                </div>
            </div>
        </div>
    </div>

    <!-- New: Appointment Modal -->
    <div class="modal-overlay" id="appointmentModalOverlay" style="display:none;">
        <div class="appointment-modal">
            <div class="modal-header">
                <h2>Book Appointment</h2>
                <span class="close-btn" onclick="hideAppointmentModal()">&times;</span>
            </div>
            <form id="appointmentForm">
                <div class="form-group">
                    <label for="specialtySelect">Specialty:</label>
                    <select id="specialtySelect" required>
                        <option value="">Select Specialty</option>
                        <option value="Cardiology">Cardiology</option>
                        <option value="Dentistry">Dentistry</option>
                        <option value="Orthopedics">Orthopedics</option>
                    </select>
                </div>
                <div class="calendar">
                    <h3>Select Date</h3>
                    <input type="date" id="appointmentDate" required>
                </div>
                <div class="time-slots" id="timeSlots"></div>
                <button type="submit" class="submit-btn">Confirm Booking</button>
            </form>
        </div>
    </div>

    <!-- New: Quick Consult Modal -->
    <div class="modal-overlay" id="quickConsultModalOverlay" style="display:none;">
        <div class="login-modal">
            <div class="modal-header">
                <h2>Quick Consult</h2>
                <span class="close-btn" onclick="hideQuickConsult()">&times;</span>
            </div>
            <form id="consultForm">
                <div class="form-group">
                    <label for="consultIssue">Describe Your Issue:</label>
                    <textarea id="consultIssue" rows="4" placeholder="Tell us about your symptoms..." required></textarea>
                </div>
                <button type="submit" class="submit-btn">Send Query</button>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script>
        // Existing Firebase Config and Auth Logic (unchanged)
        const firebaseConfig = {
            apiKey: "AIzaSyBIGxImEMAlJn_LvTD6XLs4DRAfeW6-784",
            authDomain: "user-autrhentication.firebaseapp.com",
            projectId: "user-autrhentication", 
        };
        if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
        const auth = firebase.auth();

        // Hardcoded medical summaries to make the feature work without API key
        const medicalSummaries = {
            "Cardiology": "Cardiology is the branch of medicine that deals with diseases and conditions of the heart and blood vessels. Specialists handle common issues like heart attacks, arrhythmias, and hypertension through diagnostics, medications, and procedures such as stents or pacemakers. Regular check-ups can prevent many cardiovascular risks.",
            "Family Medicine": "Family Medicine provides comprehensive primary care for individuals and families across all ages, genders, and diseases. It covers preventive health, chronic disease management, and acute care, including vaccinations, routine exams, and treatment for common illnesses like flu or diabetes monitoring.",
            "Dentistry": "Dentistry focuses on the diagnosis, prevention, and treatment of oral health issues. Common services include cleanings, fillings for cavities, root canals, and orthodontics for alignment. Maintaining good hygiene helps prevent gum disease and tooth decay.",
            "Orthopedics": "Orthopedics specializes in the musculoskeletal system, including bones, joints, ligaments, and muscles. It treats fractures, arthritis, sports injuries, and performs surgeries like joint replacements. Physical therapy often aids recovery.",
            "Neurology": "Neurology studies and treats disorders of the nervous system, such as the brain, spinal cord, and nerves. Conditions like migraines, epilepsy, stroke, and Parkinson's are managed with medications, therapy, or advanced interventions.",
            "Pulmonology": "Pulmonology deals with respiratory system diseases affecting the lungs and airways. It addresses asthma, COPD, pneumonia, and sleep apnea through inhalers, oxygen therapy, or pulmonary rehab. Smoking cessation is key for prevention."
        };

        // Existing Element References and Functions (unchanged - clearLoginError, setLoginError, etc.)
        const loginButton = document.getElementById('loginButton');
        const userPill = document.getElementById('userPill');
        const userEmailDisplay = document.getElementById('userEmailDisplay');
        const userDropdown = document.getElementById('userDropdown');
        const logoutLink = document.getElementById('logoutLink');
        const loginModalOverlay = document.getElementById('loginModalOverlay');
        const signupModalOverlay = document.getElementById('signupModalOverlay');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const loginErrorMessage = document.getElementById('loginErrorMessage');
        const signupEmailInput = document.getElementById('signupEmail');
        const signupPasswordInput = document.getElementById('signupPassword');
        const signupErrorMessage = document.getElementById('signupErrorMessage');
        const loginCloseBtn = document.querySelector('.login-close-btn');
        const signupCloseBtn = document.querySelector('.signup-close-btn');
        const showSignupLink = document.getElementById('showSignupLink');
        const showLoginLink = document.getElementById('showLoginLink');
        const medicalInfoModalOverlay = document.getElementById('medicalInfoModalOverlay');
        const medicalInfoCloseBtn = document.querySelector('.medical-info-close-btn');
        const medicalInfoTitle = document.getElementById('medicalInfoTitle');
        const medicalInfoLoading = document.getElementById('medicalInfoLoading');
        const medicalInfoResult = document.getElementById('medicalInfoResult');
        const medicalInfoText = document.getElementById('medicalInfoText');
        const medicalInfoSources = document.getElementById('medicalInfoSources');
        const specialtiesGrid = document.getElementById('specialtiesGrid');
        const hospitalsSection = document.getElementById('hospitalsSection');
        const hospitalsLoading = document.getElementById('hospitalsLoading');
        const hospitalsGrid = document.getElementById('hospitalsGrid');
        const noHospitals = document.getElementById('noHospitals');
        let currentCity = "Detecting...";
        let currentLatitude = null;
        let currentLongitude = null;
        let isShowingCity = true;
        const locationText = document.getElementById("locationText");
        const locationDropdown = document.getElementById("locationDropdown");
        const citySelect = document.getElementById("citySelect");
        const locationPill = document.getElementById('location');
        const locationToggleBtn = document.getElementById('locationToggleBtn');

        // Existing Auth Functions (updateUIAfterAuth, showLoginModal, etc. - unchanged)
        function clearLoginError() { loginErrorMessage.textContent = ''; loginErrorMessage.style.display = 'none'; }
        function setLoginError(message) { loginErrorMessage.textContent = message; loginErrorMessage.style.display = 'block'; }
        function clearSignupError() { signupErrorMessage.textContent = ''; signupErrorMessage.style.display = 'none'; }
        function setSignupError(message) { signupErrorMessage.textContent = message; signupErrorMessage.style.display = 'block'; }
        function updateUIAfterAuth(user) {
            if (user) {
                loginButton.style.display = 'none';
                userPill.style.display = 'flex';
                const displayName = user.email ? user.email.split('@')[0] : 'User';
                userEmailDisplay.textContent = displayName;
            } else {
                loginButton.style.display = 'flex';
                userPill.style.display = 'none';
                userDropdown.style.display = 'none';
            }
        }
        function toggleUserDropdown() { userDropdown.style.display = userDropdown.style.display === 'block' ? 'none' : 'block'; }
        function showLoginModal(event) {
            if (event) event.preventDefault();
            signupModalOverlay.style.display = 'none';
            medicalInfoModalOverlay.style.display = 'none';
            loginModalOverlay.style.display = 'flex';
            document.body.classList.add('modal-open');
            clearLoginError();
            signupForm.reset();
        }
        function hideLoginModal() {
            loginModalOverlay.style.display = 'none';
            document.body.classList.remove('modal-open');
            loginForm.reset();
            clearLoginError();
        }
        function hideAllModals() { hideLoginModal(); hideSignupModal(); hideMedicalInfoModal(); }
        function showSignupModal(event) {
            if (event) event.preventDefault();
            loginModalOverlay.style.display = 'none';
            medicalInfoModalOverlay.style.display = 'none';
            signupModalOverlay.style.display = 'flex';
            document.body.classList.add('modal-open');
            clearSignupError();
            loginForm.reset();
        }
        function hideSignupModal() {
            signupModalOverlay.style.display = 'none';
            document.body.classList.remove('modal-open');
            signupForm.reset();
            clearSignupError();
        }
        function showMedicalInfoModal(title, specialty) {
            medicalInfoTitle.textContent = title;
            medicalInfoModalOverlay.style.display = 'flex';
            document.body.classList.add('modal-open');
            medicalInfoResult.style.display = 'none';
            medicalInfoLoading.style.display = 'block';
            medicalInfoText.textContent = '';
            medicalInfoSources.innerHTML = '';
            // Use hardcoded summary instead of API
            setTimeout(() => {
                const summary = medicalSummaries[specialty] || "No summary available for this specialty. Please consult a doctor for personalized advice.";
                medicalInfoText.textContent = summary;
                medicalInfoSources.innerHTML = '<strong>Sources:</strong> Curated medical knowledge base.';
                medicalInfoLoading.style.display = 'none';
                medicalInfoResult.style.display = 'block';
            }, 1500); // Simulate loading delay
        }
        function hideMedicalInfoModal() {
            medicalInfoModalOverlay.style.display = 'none';
            document.body.classList.remove('modal-open');
        }
        // Updated fetchMedicalSummary to use hardcoded data (removed API call)
        async function fetchMedicalSummary(specialty) {
            // This is now handled directly in showMedicalInfoModal for simplicity
            console.log(`Summary for ${specialty} loaded from local data.`);
        }
        function copySummary() {
            const textToCopy = medicalInfoTitle.textContent + "\n\n" + medicalInfoText.textContent;
            if (navigator.clipboard) {
                navigator.clipboard.writeText(textToCopy).then(() => {
                    const btn = document.querySelector('#medicalInfoResult .submit-btn');
                    const originalText = btn.innerHTML;
                    btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                    setTimeout(() => { btn.innerHTML = originalText; }, 1500);
                }).catch(err => { fallbackCopyTextToClipboard(textToCopy); });
            } else { fallbackCopyTextToClipboard(textToCopy); }
        }
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed"; textArea.style.top = "0"; textArea.style.left = "0"; textArea.style.opacity = "0";
            document.body.appendChild(textArea); textArea.focus(); textArea.select();
            try {
                document.execCommand('copy');
                const btn = document.querySelector('#medicalInfoResult .submit-btn');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                setTimeout(() => { btn.innerHTML = originalText; }, 1500);
            } catch (err) { console.error('Fallback: Oops, unable to copy', err); }
            document.body.removeChild(textArea);
        }
        // Existing calculateDistance, fetchNearbyHospitals, getCityFromNominatimResponse, toggleLocationDisplay, success, fail, showDropdown (unchanged)
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371;
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return R * c;
        }
        async function fetchNearbyHospitals(lat, lon) {
            const radius = 5000;
            const overpassQuery = `[out:json];(node["amenity"="hospital"](around:${radius},${lat},${lon});way["amenity"="hospital"](around:${radius},${lat},${lon});relation["amenity"="hospital"](around:${radius},${lat},${lon}););out;`;
            const overpassUrl = `http://overpass-api.de/api/interpreter?data=${encodeURIComponent(overpassQuery)}`;
            try {
                const response = await fetch(overpassUrl);
                const data = await response.json();
                if (data.elements && data.elements.length > 0) {
                    const hospitals = data.elements
                        .map(el => {
                            const tags = el.tags || {};
                            const lat = el.lat || (el.center && el.center.lat);
                            const lon = el.lon || (el.center && el.center.lon);
                            if (!lat || !lon) return null;
                            const distance = calculateDistance(currentLatitude, currentLongitude, parseFloat(lat), parseFloat(lon));
                            return {
                                name: tags.name || tags['name:en'] || 'Unnamed Hospital',
                                address: tags['addr:street'] || tags['addr:city'] || 'Address not available',
                                lat: parseFloat(lat),
                                lon: parseFloat(lon),
                                distance: distance
                            };
                        })
                        .filter(h => h !== null)
                        .sort((a, b) => a.distance - b.distance)
                        .slice(0, 6);
                    if (hospitals.length > 0) {
                        hospitalsGrid.innerHTML = hospitals.map((h, i) => `
                            <div class="hospital-card">
                                <h3>${i + 1}. ${h.name}</h3>
                                <p>${h.address} - ${h.distance.toFixed(1)} km away</p>
                                <a href="https://www.google.com/maps/dir/?api=1&destination=${h.lat},${h.lon}" target="_blank">
                                    <i class="fas fa-directions"></i> Get Directions
                                </a>
                            </div>
                        `).join('');
                        hospitalsGrid.style.display = 'grid';
                        noHospitals.style.display = 'none';
                    } else {
                        hospitalsGrid.style.display = 'none';
                        noHospitals.style.display = 'block';
                    }
                } else {
                    hospitalsGrid.style.display = 'none';
                    noHospitals.style.display = 'block';
                }
            } catch (error) {
                console.error('Error fetching hospitals:', error);
                hospitalsGrid.style.display = 'none';
                noHospitals.innerHTML = '<p>Error loading nearby hospitals. Please try again later.</p>';
                noHospitals.style.display = 'block';
            } finally {
                hospitalsLoading.style.display = 'none';
            }
        }
        function getCityFromNominatimResponse(data) {
            if (!data || !data.address) return "Detected Location";
            const address = data.address;
            return address.city || address.town || address.village || address.county || address.state || "Detected Location";
        }
        function toggleLocationDisplay(event) {
            if (event) event.stopPropagation();
            if (currentLatitude !== null && currentLongitude !== null) {
                isShowingCity = !isShowingCity;
                if (isShowingCity) { locationText.textContent = currentCity; } else {
                    locationText.textContent = `Lat: ${currentLatitude.toFixed(4)}, Lon: ${currentLongitude.toFixed(4)}`;
                }
            }
        }
        function success(position) {
            currentLatitude = position.coords.latitude;
            currentLongitude = position.coords.longitude;
            locationToggleBtn.style.display = 'block';
            const nominatimUrl = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${currentLatitude}&lon=${currentLongitude}&addressdetails=1&zoom=10`;
            fetch(nominatimUrl, { headers: { 'User-Agent': 'HospitalPortal/1.0' } })
                .then(res => res.json())
                .then(data => {
                    currentCity = getCityFromNominatimResponse(data);
                    isShowingCity = true;
                    locationText.textContent = currentCity;
                    hospitalsSection.style.display = 'block';
                    fetchNearbyHospitals(currentLatitude, currentLongitude);
                })
                .catch(error => {
                    console.error("Nominatim Reverse Geocoding API Error:", error);
                    currentCity = "Detected Location";
                    locationText.textContent = currentCity;
                    hospitalsSection.style.display = 'block';
                    fetchNearbyHospitals(currentLatitude, currentLongitude);
                });
        }
        function fail() { showDropdown(); }
        function showDropdown() {
            currentCity = "Select Location";
            locationText.textContent = currentCity;
            locationToggleBtn.style.display = 'none';
            currentLatitude = null;
            currentLongitude = null;
            isShowingCity = true;
        }

        // Existing Event Listeners (auth.onAuthStateChanged, loginButton.addEventListener, etc. - unchanged)
        auth.onAuthStateChanged((user) => { updateUIAfterAuth(user); });
        loginButton.addEventListener('click', showLoginModal);
        userPill.addEventListener('click', (e) => { e.stopPropagation(); toggleUserDropdown(); });
        logoutLink.addEventListener('click', (event) => {
            event.preventDefault();
            auth.signOut().then(() => { updateUIAfterAuth(null); userDropdown.style.display = 'none'; }).catch((error) => { console.error("Logout Error:", error); });
        });
        loginCloseBtn.addEventListener('click', hideLoginModal);
        signupCloseBtn.addEventListener('click', hideSignupModal);
        medicalInfoCloseBtn.addEventListener('click', hideMedicalInfoModal);
        showSignupLink.addEventListener('click', showSignupModal);
        showLoginLink.addEventListener('click', showLoginModal);
        document.addEventListener("click", (e) => {
            if (e.target === loginModalOverlay) { hideLoginModal(); }
            if (e.target === signupModalOverlay) { hideSignupModal(); }
            if (e.target === medicalInfoModalOverlay) { hideMedicalInfoModal(); }
            if (!userPill.contains(e.target)) { userDropdown.style.display = 'none'; }
        });
        specialtiesGrid.addEventListener('click', (event) => {
            let targetCard = event.target.closest('.specialty-card');
            if (targetCard) {
                const specialty = targetCard.getAttribute('data-specialty');
                if (specialty) { 
                    showMedicalInfoModal(`What is ${specialty}?`, specialty); 
                    fetchMedicalSummary(specialty); // Now just logs, summary loaded in modal
                }
            }
        });
        loginForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const email = usernameInput.value;
            const password = passwordInput.value;
            clearLoginError();
            auth.signInWithEmailAndPassword(email, password)
                .then(() => { hideAllModals(); })
                .catch((error) => {
                    const errorCode = error.code;
                    if (errorCode === 'auth/user-not-found' || errorCode === 'auth/wrong-password' || errorCode === 'auth/invalid-email') {
                        setLoginError("Wrong details. Please check your email and password.");
                    } else {
                        setLoginError(`Login failed. Error: ${error.message}`);
                        console.error("Firebase Login Error:", error);
                    }
                });
        });
        signupForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const email = signupEmailInput.value;
            const password = signupPasswordInput.value;
            clearSignupError();
            auth.createUserWithEmailAndPassword(email, password)
                .then(() => { hideAllModals(); })
                .catch((error) => {
                    const errorCode = error.code;
                    let message = "Registration failed.";
                    if (errorCode === 'auth/email-already-in-use') { message = "This email is already registered. Please login instead."; }
                    else if (errorCode === 'auth/invalid-email') { message = "Invalid email format."; }
                    else if (errorCode === 'auth/weak-password') { message = "Password must be at least 6 characters long."; }
                    else { message = `Registration failed: ${error.message}`; }
                    setSignupError(message);
                    console.error("Firebase Signup Error:", error);
                });
        });
        window.addEventListener("load", () => {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(success, fail, { enableHighAccuracy: true, timeout: 5000 });
            } else { showDropdown(); }
        });
        locationToggleBtn.addEventListener('click', toggleLocationDisplay);
        locationPill.addEventListener("click", (e) => {
            if (e.target !== locationToggleBtn && !locationToggleBtn.contains(e.target)) {
                e.stopPropagation();
                if (locationDropdown.style.display === "block") { locationDropdown.style.display = "none"; } else { locationDropdown.style.display = "block"; }
            }
        });
        citySelect.addEventListener("change", () => {
            if (citySelect.value) {
                currentCity = citySelect.value;
                locationText.textContent = currentCity;
                locationDropdown.style.display = "none";
                locationToggleBtn.style.display = 'none';
                currentLatitude = null;
                currentLongitude = null;
                isShowingCity = true;
                hospitalsSection.style.display = 'none';
            }
        });
        document.addEventListener("click", (e) => {
            if (!document.querySelector('.location-wrapper').contains(e.target)) { locationDropdown.style.display = "none"; }
        });

        // New: Search Functionality
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        const mockSearchData = [
            { name: 'Dr. John Doe - Cardiologist', specialty: 'Cardiology' },
            { name: 'Dr. Jane Smith - Dentist', specialty: 'Dentistry' },
            { name: 'Hypertension Treatment', condition: 'Medical Condition' },
            { name: 'Root Canal Procedure', treatment: 'Dental Treatment' }
        ];
        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            if (query.length < 2) { searchResults.style.display = 'none'; return; }
            const filtered = mockSearchData.filter(item => 
                item.name.toLowerCase().includes(query) || item.specialty?.toLowerCase().includes(query)
            );
            searchResults.innerHTML = filtered.map(item => `<div class="search-result-item" onclick="selectSearchResult('${item.name}')">${item.name}</div>`).join('');
            searchResults.style.display = filtered.length ? 'block' : 'none';
        });
        function selectSearchResult(result) {
            alert(`Selected: ${result}`); // Replace with navigation or modal
            searchInput.value = '';
            searchResults.style.display = 'none';
        }

        // New: Auto-scrolling Testimonials
        const carousel = document.getElementById('testimonialCarousel');
        let scrollInterval = setInterval(() => {
            carousel.scrollLeft += carousel.offsetWidth / 3;
            if (carousel.scrollLeft >= carousel.scrollWidth - carousel.offsetWidth) { carousel.scrollLeft = 0; }
        }, 4000);
        carousel.addEventListener('mouseenter', () => clearInterval(scrollInterval));
        carousel.addEventListener('mouseleave', () => {
            scrollInterval = setInterval(() => {
                carousel.scrollLeft += carousel.offsetWidth / 3;
                if (carousel.scrollLeft >= carousel.scrollWidth - carousel.offsetWidth) { carousel.scrollLeft = 0; }
            }, 4000);
        });

        // New: Appointment Modal Functions
        const appointmentModalOverlay = document.getElementById('appointmentModalOverlay');
        const appointmentDate = document.getElementById('appointmentDate');
        const timeSlots = document.getElementById('timeSlots');
        const appointmentForm = document.getElementById('appointmentForm');
        function showAppointmentModal() {
            appointmentModalOverlay.style.display = 'flex';
            document.body.classList.add('modal-open');
            appointmentDate.valueAsDate = new Date();
            generateTimeSlots();
        }
        function hideAppointmentModal() {
            appointmentModalOverlay.style.display = 'none';
            document.body.classList.remove('modal-open');
        }
        function generateTimeSlots() {
            const slots = ['09:00 AM', '10:00 AM', '11:00 AM', '02:00 PM', '03:00 PM', '04:00 PM'];
            timeSlots.innerHTML = slots.map(slot => `<div class="time-slot" onclick="selectTimeSlot(this)">${slot}</div>`).join('');
        }
        function selectTimeSlot(slot) {
            document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
            slot.classList.add('selected');
        }
        appointmentForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const selectedTime = document.querySelector('.time-slot.selected');
            if (selectedTime) {
                alert('Appointment booked successfully!'); // Simulate booking
                hideAppointmentModal();
            } else {
                alert('Please select a time slot.');
            }
        });
        appointmentDate.addEventListener('change', generateTimeSlots);

        // New: Quick Consult
        function showQuickConsult() {
            document.getElementById('quickConsultModalOverlay').style.display = 'flex';
            document.body.classList.add('modal-open');
        }
        function hideQuickConsult() {
            document.getElementById('quickConsultModalOverlay').style.display = 'none';
            document.body.classList.remove('modal-open');
        }
        document.getElementById('consultForm').addEventListener('submit', (e) => {
            e.preventDefault();
            alert('Your query has been sent to our team. We\'ll respond soon!'); // Simulate
            hideQuickConsult();
        });

        // New: Newsletter Signup
        function subscribeNewsletter() {
            const email = document.getElementById('newsletterEmail').value;
            if (email) {
                alert('Thank you for subscribing!'); // Simulate
                document.getElementById('newsletterEmail').value = '';
            } else {
                alert('Please enter your email.');
            }
        }

        // Close modals on overlay click
        appointmentModalOverlay.addEventListener('click', (e) => { if (e.target === appointmentModalOverlay) hideAppointmentModal(); });
        document.getElementById('quickConsultModalOverlay').addEventListener('click', (e) => { if (e.target === document.getElementById('quickConsultModalOverlay')) hideQuickConsult(); });
    </script>
</body>

</html>

